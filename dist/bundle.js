(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{A:()=>ke});var t=function(e,t,n,o,i){return o+(Math.max(Math.min(e,n),t)-t)/(n-t)*(i-o)},n=function(e,t,n){return e.position.clone().sub(t.position.clone()).length()<n},o=function(e,t,n,o){return[e[0],e[1],e[2],t[0],t[1],t[2],n[0],n[1],n[2],t[0],t[1],t[2],n[0],n[1],n[2],o[0],o[1],o[2]]},i={red:15881030,orange:16753920,white:14209233,brown:5845806,brownDark:2300175,pink:16095342,yellow:16043667,blue:6865856,lightPurple:13148872,green:65280,black:0,lightGreen:9498256,darkGreen:25600,gold:16766720},a=16766720,s=a;const r=i;function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,c(o.key),o)}}function c(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}var d=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"human";switch(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mesh=new THREE.Object3D,this.angleHairs=0,this.pilotType=t,t){case"frog":this.createFrogPilot();break;case"nouns":this.createNounsPilot();break;default:this.createHumanPilot()}},(t=[{key:"createHumanPilot",value:function(){this.mesh=new THREE.Object3D,this.angleHairs=0;var e=new THREE.BoxGeometry(15,15,15),t=new THREE.MeshPhongMaterial({color:r.brown,flatShading:!0}),n=new THREE.Mesh(e,t);n.position.set(2,-12,0),this.mesh.add(n);var o=new THREE.BoxGeometry(10,10,10),i=new THREE.MeshLambertMaterial({color:r.pink}),a=new THREE.Mesh(o,i);this.mesh.add(a);var s=new THREE.BoxGeometry(4,4,4),l=new THREE.MeshLambertMaterial({color:r.brown}),h=new THREE.Mesh(s,l);h.geometry.applyMatrix4((new THREE.Matrix4).makeTranslation(0,2,0));var c=new THREE.Object3D;this.hairsTop=new THREE.Object3D;for(var d=0;d<12;d++){var u=h.clone(),p=d%3,m=Math.floor(d/3);u.position.set(4*m-4,0,4*p-4),u.geometry.applyMatrix4((new THREE.Matrix4).makeScale(1,1,1)),this.hairsTop.add(u)}c.add(this.hairsTop);var f=new THREE.BoxGeometry(12,4,2);f.applyMatrix4((new THREE.Matrix4).makeTranslation(-6,0,0));var y=new THREE.Mesh(f,l),v=y.clone();y.position.set(8,-2,6),v.position.set(8,-2,-6),c.add(y),c.add(v);var E=new THREE.BoxGeometry(2,8,10),w=new THREE.Mesh(E,l);w.position.set(-1,-4,0),c.add(w),c.position.set(-5,5,0),this.mesh.add(c);var M=new THREE.BoxGeometry(5,5,5),g=new THREE.MeshLambertMaterial({color:r.brown}),T=new THREE.Mesh(M,g);T.position.set(6,0,3);var b=T.clone();b.position.z=-T.position.z;var S=new THREE.BoxGeometry(11,1,11),R=new THREE.Mesh(S,g);this.mesh.add(T),this.mesh.add(b),this.mesh.add(R);var H=new THREE.BoxGeometry(2,3,2),x=new THREE.Mesh(H,i);x.position.set(0,0,-6);var P=x.clone();P.position.set(0,0,6),this.mesh.add(x),this.mesh.add(P)}},{key:"createFrogPilot",value:function(){var e=this,t=new THREE.SphereGeometry(7.5,32,32);!function(e){for(var t=e.attributes.position.array,n=0;n<t.length;n+=3){var o=.2*(Math.random()-.5);t[n]+=o,t[n+1]+=o,t[n+2]+=o}e.attributes.position.needsUpdate=!0,e.computeVertexNormals()}(t);var n=new THREE.MeshPhongMaterial({color:r.green,flatShading:!1,shininess:30}),o=new THREE.Mesh(t,n);this.mesh.add(o);var i=new THREE.SphereGeometry(2,32,32),a=new THREE.MeshPhongMaterial({color:r.white,flatShading:!1,shininess:100}),s=new THREE.Mesh(i,a);s.position.set(3,4,4),this.mesh.add(s);var l=s.clone();l.position.set(3,4,-4),this.mesh.add(l);var h=new THREE.SphereGeometry(1,32,32),c=new THREE.MeshPhongMaterial({color:r.black,flatShading:!1,shininess:100}),d=new THREE.Mesh(h,c);d.position.set(4,4,4),this.mesh.add(d);var u=d.clone();u.position.set(4,4,-4),this.mesh.add(u);var p=new THREE.Shape;p.moveTo(-3,0),p.quadraticCurveTo(0,-2,3,0);var m=new THREE.ShapeGeometry(p),f=new THREE.MeshPhongMaterial({color:r.darkGreen,side:THREE.DoubleSide}),y=new THREE.Mesh(m,f);y.position.set(3,-2,0),y.rotation.x=.5*Math.PI,this.mesh.add(y);var v=new THREE.BoxGeometry(1,.5,4),E=new THREE.MeshPhongMaterial({color:r.red,flatShading:!1}),w=new THREE.Mesh(v,E);w.position.set(3,-2,2),w.rotation.x=.25*Math.PI,this.mesh.add(w);var M=new THREE.Shape;M.moveTo(-1.5,0),M.lineTo(-.5,2),M.lineTo(.5,2),M.lineTo(1.5,0),M.lineTo(-1.5,0);var g=new THREE.ShapeGeometry(M),T=new THREE.MeshPhongMaterial({color:r.darkGreen,side:THREE.DoubleSide,flatShading:!1}),b=[{x:-3,y:-7,z:3},{x:3,y:-7,z:3},{x:-3,y:-7,z:-3},{x:3,y:-7,z:-3}];b.forEach((function(t){var n=new THREE.Mesh(g,T);n.position.set(t.x,t.y,t.z),n.rotation.x=.5*Math.PI,e.mesh.add(n)}));var S=new THREE.SphereGeometry(3,32,16,0,2*Math.PI,0,.5*Math.PI),R=new THREE.MeshPhongMaterial({color:r.lightGreen,flatShading:!1,transparent:!0,opacity:.7}),H=new THREE.Mesh(S,R);H.position.set(0,-5,6),H.rotation.x=Math.PI,this.mesh.add(H);var x=new THREE.Group,P=new THREE.CylinderGeometry(6,7,12,32),k=new THREE.MeshPhongMaterial({color:r.black,flatShading:!0}),C=new THREE.Mesh(P,k);C.position.set(0,6,0),x.add(C);var L=new THREE.TorusGeometry(6.5,1,16,100),B=new THREE.MeshPhongMaterial({color:r.gold,flatShading:!0}),G=new THREE.Mesh(L,B);G.position.set(0,1,0),G.rotation.x=.5*Math.PI,x.add(G);var D=new THREE.BoxGeometry(4,6,.1),j=new THREE.MeshPhongMaterial({color:r.white,flatShading:!0}),I=new THREE.Mesh(D,j);I.position.set(4,4,0),I.rotation.z=Math.PI/12,x.add(I);var z=new THREE.Shape;z.moveTo(0,0),z.bezierCurveTo(0,-1,-1,-1,-1,0),z.bezierCurveTo(-1,1,0,1,0,2),z.bezierCurveTo(0,1,1,1,1,0),z.bezierCurveTo(1,-1,0,-1,0,0);var A=new THREE.ShapeGeometry(z),O=new THREE.MeshPhongMaterial({color:r.red,flatShading:!0}),F=new THREE.Mesh(A,O);F.scale.set(1,1,1),F.position.set(4,4,.1),x.add(F),x.position.set(0,10,0),x.scale.set(1.5,1.5,1.5),this.mesh.add(x);var U=new THREE.Group,_=new THREE.BoxGeometry(3,1,.5),W=new THREE.MeshPhongMaterial({color:r.red,flatShading:!0}),X=new THREE.Mesh(_,W);X.position.set(-1,0,0),X.rotation.z=Math.PI/6;var V=X.clone();V.position.set(1,0,0),V.rotation.z=-Math.PI/6;var q=new THREE.Mesh(new THREE.BoxGeometry(.5,.5,.5),W);U.add(X,V,q),U.position.set(3,-3,6),this.mesh.add(U);for(var Y=new THREE.CircleGeometry(.3,32),K=new THREE.MeshPhongMaterial({color:r.darkGreen,flatShading:!0}),N=0;N<20;N++){var J=new THREE.Mesh(Y,K),Z=Math.random()*Math.PI*2,$=Math.random()*Math.PI,Q=7.5*Math.sin($)*Math.cos(Z),ee=7.5*Math.sin($)*Math.sin(Z),te=7.5*Math.cos($);J.position.set(Q,ee,te),J.lookAt(0,0,0),this.mesh.add(J)}new THREE.CylinderGeometry(.5,.5,3,32),new THREE.MeshPhongMaterial({color:r.green,flatShading:!0});var ne=new THREE.SphereGeometry(.8,32,32),oe=new THREE.MeshPhongMaterial({color:r.darkGreen,flatShading:!0});b.forEach((function(t){var n=new THREE.Mesh(ne,oe);n.position.set(t.x,t.y-1.5,t.z),n.scale.set(1,.5,1.5),e.mesh.add(n)}))}},{key:"createNounsPilot",value:function(){var e=new THREE.BoxGeometry(15,15,15),t=new THREE.MeshPhongMaterial({color:r.yellow,flatShading:!0}),n=new THREE.Mesh(e,t);this.mesh.add(n);var o=new THREE.BoxGeometry(16,6,1),i=new THREE.MeshPhongMaterial({color:r.black,flatShading:!0}),a=new THREE.Mesh(o,i);a.position.set(0,2,7.5),this.mesh.add(a);var s=new THREE.TorusGeometry(3,1,16,100,Math.PI),l=new THREE.MeshPhongMaterial({color:r.black,flatShading:!0}),h=new THREE.Mesh(s,l);h.position.set(0,-2,7.5),h.rotation.x=Math.PI,this.mesh.add(h),this.addHyperLargeGlasses()}},{key:"addHyperLargeGlasses",value:function(){var e=new THREE.Group,t=new THREE.BoxGeometry(60,20,2),n=new THREE.MeshPhongMaterial({color:r.yellow}),o=new THREE.Mesh(t,n);o.position.set(0,5,12),e.add(o);var i=new THREE.BoxGeometry(24,16,1),a=new THREE.MeshPhongMaterial({color:65535,transparent:!0,opacity:.7}),s=new THREE.Mesh(i,a);s.position.set(-15,5,13),e.add(s);var l=s.clone();l.position.set(15,5,13),e.add(l);var h=new THREE.BoxGeometry(20,2,1),c=new THREE.MeshPhongMaterial({color:r.yellow}),d=new THREE.Mesh(h,c);d.position.set(-30,5,9),d.rotation.y=Math.PI/6,e.add(d);var u=d.clone();u.position.set(30,5,9),u.rotation.y=-Math.PI/6,e.add(u),e.scale.set(1.5,1.5,1.5),e.position.set(0,4,5),this.mesh.add(e)}},{key:"updateHairs",value:function(e){if("human"===this.pilotType){for(var t=this.hairsTop.children,n=t.length,o=0;o<n;o++)t[o].scale.y=.75+.25*Math.cos(this.angleHairs+o/3);this.angleHairs+=ke.speed*e*40}}}])&&h(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function p(e){console.log("Creating blimp mesh with pilot type:",e);var t=new THREE.Object3D,n=new THREE.SphereGeometry(40,32,32),o=new THREE.MeshPhongMaterial({color:65280,flatShading:!0}),i=new THREE.Mesh(n,o);i.scale.set(2,1,1),t.add(i);var a=new THREE.BoxGeometry(5,5,5);[{color:0,position:[30,0,10]},{color:16711680,position:[30,0,-10]},{color:255,position:[-30,0,10]},{color:32768,position:[-30,0,-10]}].forEach((function(e){var t,n,o=e.color,s=e.position,r=new THREE.MeshPhongMaterial({color:o}),l=new THREE.Mesh(a,r);(t=l.position).set.apply(t,function(e){if(Array.isArray(e))return u(e)}(n=s)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i.add(l)}));var s=new THREE.BoxGeometry(20,10,15),r=new THREE.MeshPhongMaterial({color:9127187,flatShading:!0}),l=new THREE.Mesh(s,r);l.position.set(0,-25,0),t.add(l);var h=new THREE.CylinderGeometry(10,10,20,32),c=new THREE.MeshPhongMaterial({color:16766720,flatShading:!0}),p=new THREE.Mesh(h,c);p.position.set(-60,-25,0);var m=new THREE.BoxGeometry(1,80,10),f=new THREE.MeshPhongMaterial({color:0,flatShading:!0}),y=new THREE.Mesh(m,f),v=y.clone();v.rotation.x=Math.PI/2,p.add(y),p.add(v),t.add(p);var E=new d(e);return E.mesh.position.set(0,-35,0),t.add(E.mesh),t.castShadow=!0,t.receiveShadow=!0,[t,p,E]}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,y(o.key),o)}}function y(e){var t=function(e){if("object"!=m(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}var v=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.aircraftOptions=[{id:"airplane",emoji:"✈️"},{id:"blimp",emoji:"🎈"},{id:"fighterJet",emoji:"🛩️"}],this.selectedAircraft="airplane"},(t=[{key:"getAircraftOptions",value:function(){return this.aircraftOptions}},{key:"setSelectedAircraft",value:function(e){this.aircraftOptions.some((function(t){return t.id===e}))?this.selectedAircraft=e:console.error("Invalid aircraft selection: ".concat(e))}},{key:"getSelectedAircraft",value:function(){return this.selectedAircraft}}])&&f(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}());function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function w(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,M(o.key),o)}}function M(e){var t=function(e){if("object"!=E(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==E(t)?t:t+""}var g=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mesh=new THREE.Object3D;var t=new THREE.BoxGeometry(20,20,20);this.rainbowColors=[16711680,16744192,16776960,65280,255,9109759];for(var n=5+Math.floor(3*Math.random()),o=0;o<n;o++){var i=new THREE.MeshPhongMaterial({color:this.rainbowColors[o%this.rainbowColors.length],emissive:this.rainbowColors[o%this.rainbowColors.length],emissiveIntensity:.5,shininess:100}),a=new THREE.Mesh(t.clone(),i);a.position.x=12*o,a.position.y=10*Math.random(),a.position.z=10*Math.random(),a.rotation.y=Math.random()*Math.PI*2,a.rotation.z=Math.random()*Math.PI*2;var s=.8+.5*Math.random();a.scale.set(s,s,s),this.mesh.add(a),a.castShadow=!0,a.receiveShadow=!0;var r=new THREE.MeshBasicMaterial({color:this.rainbowColors[o%this.rainbowColors.length],transparent:!0,opacity:.5}),l=new THREE.Mesh(t.clone(),r);l.scale.multiplyScalar(1.2),a.add(l)}var h=new THREE.PointLight(16777215,1,100);h.position.set(6*n,5,5),this.mesh.add(h)},(t=[{key:"tick",value:function(e){for(var t=this.mesh.children.length,n=0;n<t;n++){var o=this.mesh.children[n];if(o instanceof THREE.Mesh){o.rotation.y+=.02*Math.random()*(n+1),o.rotation.z+=.03*Math.random()*(n+1);var i=(.001*Date.now()+.1*n)%1,a=(new THREE.Color).setHSL(i,1,.5);o.material.color.set(a),o.material.emissive.set(a),o.children[0]&&o.children[0].material.color.set(a);var s=.8+.5*Math.random(),r=.1*Math.sin(.005*Date.now()+n)+1;o.scale.set(s*r,s*r,s*r)}}var l=this.mesh.children[this.mesh.children.length-1];l instanceof THREE.PointLight&&(l.intensity=1+.5*Math.sin(.005*Date.now()))}}])&&w(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function b(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,S(o.key),o)}}function S(e){var t=function(e){if("object"!=T(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==T(t)?t:t+""}var R=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.promises=[]},(t=[{key:"add",value:function(e){this.promises.push(e)}},{key:"then",value:function(e){return Promise.all(this.promises).then(e)}},{key:"catch",value:function(e){return Promise.all(this.promises).catch(e)}}])&&b(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}());function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function x(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,P(o.key),o)}}function P(e){var t=function(e){if("object"!=H(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=H(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==H(t)?t:t+""}var k=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.buffers={},this.loader=new THREE.AudioLoader,this.listener=new THREE.AudioListener,this.categories={}},t=[{key:"setCamera",value:function(e){e.add(this.listener)}},{key:"load",value:function(e,t,n){var o=this,i=new Promise((function(i,a){o.loader.load(n,(function(n){o.buffers[e]=n,null!==t&&(o.categories[t]||(o.categories[t]=[]),o.categories[t].push(e)),i()}),(function(){}),a)}));R.add(i)}},{key:"play",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e,o=this.categories[e];o&&(n=o[Math.floor(Math.random()*o.length)]);var i=this.buffers[n],a=new THREE.Audio(this.listener);a.setBuffer(i),t.loop&&a.setLoop(!0),t.volume&&a.setVolume(t.volume),a.play()}}],t&&x(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),C=new k;function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function B(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,G(o.key),o)}}function G(e){var t=function(e){if("object"!=L(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==L(t)?t:t+""}var D=new(function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.path=t,this.models={}},(t=[{key:"load",value:function(e){var t=this,n=new Promise((function(n,o){(new THREE.OBJLoader).load(t.path+"/"+e+".obj",(function(o){t.models[e]=o,n()}),(function(){}),o)}));R.add(n)}},{key:"get",value:function(e){if(void 0===this.models[e])throw new Error("Can't find model "+e);return this.models[e]}}])&&B(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}())("/models");function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function I(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,z(o.key),o)}}function z(e){var t=function(e){if("object"!=j(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==j(t)?t:t+""}var A,O=new(function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pilotOptions=[{id:"human",emoji:"👨🏼‍🦰"},{id:"frog",emoji:"🎩"},{id:"nouns",emoji:"😎"}],this.selectedPilot=null,this.selectedAircraft=null,this.startButton=null,this.startButtonTooltip=null,document.addEventListener("DOMContentLoaded",(function(){t.initSelectionScreen(),t.startButton=document.getElementById("start-game"),t.startButtonTooltip=document.getElementById("start-game-tooltip"),t.startButton.addEventListener("click",(function(){return t.handleStartClick()})),t.startButton.addEventListener("mouseenter",(function(){return t.showTooltip()})),t.startButton.addEventListener("mouseleave",(function(){return t.hideTooltip()}))}))},(t=[{key:"initSelectionScreen",value:function(){var e=this,t=document.getElementById("pilot-options"),n=document.getElementById("aircraft-options");t&&n?(this.pilotOptions.forEach((function(n){var o=e.createSelectionOption(n,"pilot");t.appendChild(o)})),v.getAircraftOptions().forEach((function(t){var o=e.createSelectionOption(t,"aircraft");n.appendChild(o)})),this.updateStartButton()):console.error("Selection containers not found in the DOM")}},{key:"createSelectionOption",value:function(e,t){var n=this,o=document.createElement("div");o.classList.add("selection-option"),o.dataset.id=e.id,o.dataset.type=t;var i=document.createElement("span");i.textContent=e.emoji,i.classList.add("selection-emoji"),o.appendChild(i);var a=document.createElement("span");return a.textContent=e.name,a.classList.add("selection-name"),o.appendChild(a),o.addEventListener("click",(function(){return n.selectOption(e.id,t)})),o}},{key:"selectOption",value:function(e,t){document.querySelectorAll('.selection-option[data-type="'.concat(t,'"]')).forEach((function(e){return e.classList.remove("selected")}));var n=document.querySelector('.selection-option[data-id="'.concat(e,'"][data-type="').concat(t,'"]'));n&&(n.classList.add("selected"),"pilot"===t?this.selectedPilot=e:"aircraft"===t&&(this.selectedAircraft=e,v.setSelectedAircraft(e))),this.updateStartButton()}},{key:"updateStartButton",value:function(){this.startButton&&(this.selectedPilot&&this.selectedAircraft?(this.startButton.classList.add("visible"),this.startButton.disabled=!1):(this.startButton.classList.remove("visible"),this.startButton.disabled=!0))}},{key:"handleStartClick",value:function(){var e=this;this.startButton.disabled?(this.showTooltip(),setTimeout((function(){return e.hideTooltip()}),2e3)):this.startMap()}},{key:"showTooltip",value:function(){if(this.startButton.disabled&&this.startButtonTooltip){this.startButtonTooltip.style.display="block",this.startButtonTooltip.classList.add("visible");var e=this.startButton.getBoundingClientRect();this.startButtonTooltip.style.top="".concat(e.bottom+10,"px"),this.startButtonTooltip.style.left="".concat(e.left+e.width/2,"px"),this.startButtonTooltip.offsetHeight,this.startButtonTooltip.style.opacity="1"}}},{key:"hideTooltip",value:function(){var e=this;this.startButtonTooltip&&(this.startButtonTooltip.style.opacity="0",setTimeout((function(){e.startButtonTooltip.classList.remove("visible"),e.startButtonTooltip.style.display="none"}),300))}},{key:"startMap",value:function(){if(this.selectedPilot&&this.selectedAircraft){console.log("Starting map with selected pilot:",this.selectedPilot,"and aircraft:",this.selectedAircraft),document.getElementById("intro-screen").classList.add("hidden"),document.querySelector(".header").classList.add("game-started");var e=document.getElementById("score-wrapper");e.classList.remove("hidden"),setTimeout((function(){e.classList.add("visible")}),50);var t=new CustomEvent("selectionComplete",{detail:{pilot:this.selectedPilot,aircraft:this.selectedAircraft}});document.dispatchEvent(t),console.log("selectionComplete event dispatched")}else console.log("Please select both a pilot and an aircraft before starting the game")}},{key:"getSelection",value:function(){return{pilot:this.selectedPilot,aircraft:this.selectedAircraft}}}])&&I(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}());function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function U(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,r=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){r=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(r)throw a}}}}function _(e,t){if(e){if("string"==typeof e)return W(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Y(o.key),o)}}function q(e,t,n){return t&&V(e.prototype,t),n&&V(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y(e){var t=function(e){if("object"!=F(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==F(t)?t:t+""}var K,N,J,Z,$,Q,ee=new(function(){return q((function e(){X(this,e),this.list=new Set}),[{key:"add",value:function(e){J.add(e.mesh),this.list.add(e)}},{key:"remove",value:function(e){J.remove(e.mesh),this.list.delete(e)}},{key:"clear",value:function(){var e,t=U(this.list);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.remove(n)}}catch(e){t.e(e)}finally{t.f()}}},{key:"tick",value:function(e){var t,n=U(this.list);try{for(n.s();!(t=n.n()).done;){var o=t.value;o.tick&&o.tick(e)}}catch(e){n.e(e)}finally{n.f()}}}])}()),te=(new Date).getTime(),ne=(new Date).getTime(),oe=function(){return q((function e(){X(this,e),this.mesh=e.createMesh(),this.mesh.position.z=28,this.mesh.position.x=25,this.mesh.position.y=-8}),[{key:"downtime",value:function(){return.1}},{key:"damage",value:function(){return 1}},{key:"shoot",value:function(e){var t=this,n=this.downtime()/1.5,o=new THREE.Vector3;this.mesh.getWorldPosition(o),o.add(new THREE.Vector3(5,0,0)),Me(this.damage(),o,e,.5,.3,3),ue(o.clone().add(new THREE.Vector3(2,0,0)),1,i.orange,.2),C.play("shot-soft");var a=this.mesh.position.x;TweenMax.to(this.mesh.position,{duration:n/2,x:a-4,onComplete:function(){TweenMax.to(t.mesh.position,{duration:n/2,x:a})}})}}],[{key:"createMesh",value:function(){var e=new THREE.MeshStandardMaterial({color:2236962,flatShading:!0,roughness:.5,metalness:1}),t=new THREE.Group,n=new THREE.Mesh(new THREE.CylinderGeometry(3,3,20),e);n.rotation.z=Math.PI/2,t.add(n);var o=new THREE.Mesh(new THREE.CylinderGeometry(1.5,1.5,20),e);return o.rotation.z=Math.PI/2,o.position.x=20,t.add(o),t}}])}(),ie=function(){return q((function e(){X(this,e),this.gun1=new oe,this.gun2=new oe,this.gun2.mesh.position.add(new THREE.Vector3(0,14,0)),this.mesh=new THREE.Group,this.mesh.add(this.gun1.mesh),this.mesh.add(this.gun2.mesh)}),[{key:"downtime",value:function(){return.15}},{key:"damage",value:function(){return this.gun1.damage()+this.gun2.damage()}},{key:"shoot",value:function(e){this.gun1.shoot(e),this.gun2.shoot(e)}}])}(),ae=function(){return q((function e(){X(this,e),this.mesh=e.createMesh(),this.mesh.position.z=28,this.mesh.position.x=-3,this.mesh.position.y=-5}),[{key:"downtime",value:function(){return.1}},{key:"damage",value:function(){return 5}},{key:"shoot",value:function(e){var t=this,n=this.downtime()/3,o=new THREE.Vector3;this.mesh.getWorldPosition(o),o.add(new THREE.Vector3(12,0,0)),Me(this.damage(),o,e,.5,.8,6),ue(o.clone().add(new THREE.Vector3(2,0,0)),3,i.orange,.5),C.play("shot-hard");var a=this.mesh.position.x;TweenMax.to(this.mesh.position,{duration:n,x:a-4,onComplete:function(){TweenMax.to(t.mesh.position,{duration:n,x:a})}})}}],[{key:"createMesh",value:function(){var e=new THREE.MeshStandardMaterial({color:2236962,flatShading:!0,roughness:.5,metalness:1}),t=new THREE.Group,n=new THREE.Mesh(new THREE.CylinderGeometry(5,5,30),e);n.rotation.z=Math.PI/2,n.position.x=15,t.add(n);var o=new THREE.Mesh(new THREE.CylinderGeometry(2.5,2.5,19.8),e);o.rotation.z=Math.PI/2,o.position.x=39.9,t.add(o);var i=new THREE.Mesh(new THREE.CylinderGeometry(3.25,3.25,7.5),e);return i.rotation.z=Math.PI/2,i.position.x=53.55,t.add(i),t}}])}(),se=function(){return q((function e(t,n,o){X(this,e),this.mesh=t,this.propeller=n,this.pilot=o,this.weapon=null,this.lastShot=0}),[{key:"equipWeapon",value:function(e){this.weapon&&this.mesh.remove(this.weapon.mesh),this.weapon=e,this.weapon&&this.mesh.add(this.weapon.mesh)}},{key:"shoot",value:function(){if(this.weapon){var e=(new Date).getTime()/1e3;if(e-this.lastShot>this.weapon.downtime()){this.lastShot=e;var t=new THREE.Vector3(10,0,0);t.applyEuler(fe.mesh.rotation),this.weapon.shoot(t);var n=this.weapon.damage();TweenMax.to(this.mesh.position,{duration:.05,x:this.mesh.position.x-n})}}}},{key:"tick",value:function(e){if(this.propeller.rotation.x+=.2+N.planeSpeed*e*.005,"playing"===N.status){N.planeSpeed=t(Re.mousePos.x,-.5,.5,K.planeMinSpeed,K.planeMaxSpeed);var n=t(Re.mousePos.x,-1,1,.7*-K.planeAmpWidth,-K.planeAmpWidth),o=t(Re.mousePos.y,-.75,.75,K.planeDefaultHeight-K.planeAmpHeight,K.planeDefaultHeight+K.planeAmpHeight);N.planeCollisionDisplacementX+=N.planeCollisionSpeedX,n+=N.planeCollisionDisplacementX,N.planeCollisionDisplacementY+=N.planeCollisionSpeedY,o+=N.planeCollisionDisplacementY,this.mesh.position.x+=(n-this.mesh.position.x)*e*K.planeMoveSensivity,this.mesh.position.y+=(o-this.mesh.position.y)*e*K.planeMoveSensivity,this.mesh.rotation.x=(this.mesh.position.y-o)*e*K.planeRotZSensivity,this.mesh.rotation.z=(o-this.mesh.position.y)*e*K.planeRotXSensivity,N.fpv?Z.position.y=this.mesh.position.y+20:(Z.fov=t(Re.mousePos.x,-30,1,40,80),Z.updateProjectionMatrix(),Z.position.y+=(this.mesh.position.y-Z.position.y)*e*K.cameraSensivity)}N.planeCollisionSpeedX+=(0-N.planeCollisionSpeedX)*e*.03,N.planeCollisionDisplacementX+=(0-N.planeCollisionDisplacementX)*e*.01,N.planeCollisionSpeedY+=(0-N.planeCollisionSpeedY)*e*.03,N.planeCollisionDisplacementY+=(0-N.planeCollisionDisplacementY)*e*.01,this.pilot.updateHairs(e)}},{key:"gethit",value:function(e){var t=this.mesh.position.clone().sub(e),n=t.length();N.planeCollisionSpeedX=100*t.x/n,N.planeCollisionSpeedY=100*t.y/n,Q.intensity=2,C.play("airplane-crash")}}])}();function re(e,t,n){e.angle+=t*N.speed*K.collectiblesSpeed,e.angle>2*Math.PI&&(e.angle-=2*Math.PI),e.mesh.position.x=Math.cos(e.angle)*e.distance,e.mesh.position.y=-K.seaRadius+Math.sin(e.angle)*e.distance}var le=function(){return q((function e(t,n){X(this,e),this.angle=0,this.distance=0,this.onApply=n,this.mesh=new THREE.Object3D;var o=new THREE.Mesh(new THREE.SphereGeometry(10,100,100),new THREE.MeshPhongMaterial({color:s,transparent:!0,opacity:.4,flatShading:!0}));this.mesh.add(o),this.mesh.add(t),this.mesh.castShadow=!0,this.angle=2*Math.PI*.1,this.distance=K.seaRadius+K.planeDefaultHeight+(2*Math.random()-1)*(K.planeAmpHeight-20),this.mesh.position.y=-K.seaRadius+Math.sin(this.angle)*this.distance,this.mesh.position.x=Math.cos(this.angle)*this.distance,ee.add(this)}),[{key:"tick",value:function(e){re(this,e,K.collectiblesSpeed),this.mesh.rotation.y+=.002*e*Math.random(),this.mesh.rotation.z+=.002*e*Math.random(),n(fe.mesh,this.mesh,K.collectibleDistanceTolerance)?(this.onApply(),this.explode()):this.angle>Math.PI&&ee.remove(this)}},{key:"explode",value:function(){var e=this;ue(this.mesh.position.clone(),15,s,3),ee.remove(this),C.play("bubble"),setTimeout((function(){for(var t=new THREE.Group,n=1;n<e.mesh.children.length;n+=1)t.add(e.mesh.children[n]);J.add(t),t.position.y=120,t.position.z=50;var o=t.scale.clone();TweenMax.to(t.scale,{duration:.5,x:4*o.x,y:4*o.y,z:4*o.z,ease:"Power2.easeInOut",onComplete:function(){TweenMax.to(t.scale,{duration:.5,x:0,y:0,z:0,ease:"Power2.easeInOut",onComplete:function(){J.remove(t)}})}})}),200)}}])}();var he=function(){return q((function e(){X(this,e),this.mesh=new THREE.Object3D,this.nClouds=20,this.clouds=[];for(var t=2*Math.PI/this.nClouds,n=0;n<this.nClouds;n++){var o=new g;this.clouds.push(o);var i=t*n,a=K.seaRadius+150+200*Math.random();o.mesh.position.y=Math.sin(i)*a,o.mesh.position.x=Math.cos(i)*a,o.mesh.position.z=-300-500*Math.random(),o.mesh.rotation.z=i+Math.PI/2;var s=1+2*Math.random();o.mesh.scale.set(s,s,s),this.mesh.add(o.mesh)}}),[{key:"tick",value:function(e){for(var t=0;t<this.nClouds;t++)this.clouds[t].tick(e);this.mesh.rotation.z+=N.speed*e}}])}(),ce=[6865856,4699055,3772043,2779752,1852740,860448],de=function(){return q((function e(){X(this,e);var t=new THREE.CylinderGeometry(K.seaRadius,K.seaRadius,K.seaLength,40,10);t.applyMatrix4((new THREE.Matrix4).makeRotationX(-Math.PI/2)),this.waves=[];for(var n=t.attributes.position.array,o=0;o<n.length/3;o++)this.waves.push({x:n[3*o+0],y:n[3*o+1],z:n[3*o+2],ang:Math.random()*Math.PI*2,amp:K.wavesMinAmp+Math.random()*(K.wavesMaxAmp-K.wavesMinAmp),speed:K.wavesMinSpeed+Math.random()*(K.wavesMaxSpeed-K.wavesMinSpeed)});var i=new THREE.MeshPhongMaterial({color:ce[0],transparent:!0,opacity:.8,flatShading:!0});this.mesh=new THREE.Mesh(t,i),this.mesh.receiveShadow=!0}),[{key:"tick",value:function(e){for(var t=this.mesh.geometry.attributes.position.array,n=0;n<t.length/3;n++){var o=this.waves[n];t[3*n+0]=o.x+Math.cos(o.ang)*o.amp,t[3*n+1]=o.y+Math.sin(o.ang)*o.amp,o.ang+=o.speed*e}this.mesh.geometry.attributes.position.needsUpdate=!0}},{key:"updateColor",value:function(){this.mesh.material=new THREE.MeshPhongMaterial({color:ce[(N.level-1)%ce.length],transparent:!0,opacity:.8,flatShading:!0})}}])}();function ue(e,t,n,o){for(var i=function(){var t=new THREE.TetrahedronGeometry(3,0),i=new THREE.MeshPhongMaterial({color:39321,shininess:0,specular:16777215,flatShading:!0}),a=new THREE.Mesh(t,i);J.add(a),a.visible=!0,a.position.copy(e),a.material.color=new THREE.Color(n),a.material.needsUpdate=!0,a.scale.set(o,o,o);var s=e.x+50*(2*Math.random()-1),r=e.y+50*(2*Math.random()-1),l=e.z+50*(2*Math.random()-1),h=.6+.2*Math.random();TweenMax.to(a.rotation,h,{x:12*Math.random(),y:12*Math.random()}),TweenMax.to(a.scale,h,{x:.1,y:.1,z:.1}),TweenMax.to(a.position,h,{x:s,y:r,z:l,delay:.1*Math.random(),ease:Power2.easeOut,onComplete:function(){J.remove(a)}})},a=0;a<t;a++)i()}var pe,me,fe,ye=function(){return q((function e(){X(this,e);var t=new THREE.TetrahedronGeometry(8,2),n=new THREE.MeshPhongMaterial({color:i.red,shininess:0,specular:16777215,flatShading:!0});this.mesh=new THREE.Mesh(t,n),this.mesh.castShadow=!0,this.angle=0,this.distance=0,this.hitpoints=3,ee.add(this)}),[{key:"tick",value:function(e){re(this,e,K.enemiesSpeed),this.mesh.rotation.y+=.1*Math.random(),this.mesh.rotation.z+=.1*Math.random(),n(fe.mesh,this.mesh,K.enemyDistanceTolerance)&&"finished"!==N.status?(this.explode(),fe.gethit(this.mesh.position),N.lifes=Math.max(0,N.lifes-1),Re.updateLifesDisplay(),N.statistics.lifesLost+=1):this.angle>Math.PI&&ee.remove(this);var t,o=(new THREE.Box3).setFromObject(this.mesh),a=U(Ee);try{for(a.s();!(t=a.n()).done;){var s=t.value,r=(new THREE.Box3).setFromObject(s.mesh);o.intersectsBox(r)&&(ue(s.mesh.position.clone(),5,i.brownDark,1),s.remove(),this.hitpoints-=s.damage,C.play("bullet-impact",{volume:.3}))}}catch(e){a.e(e)}finally{a.f()}this.hitpoints<=0&&this.explode()}},{key:"explode",value:function(){C.play("rock-shatter",{volume:3}),ue(this.mesh.position.clone(),15,i.red,3),ee.remove(this),N.statistics.enemiesKilled+=1}}])}(),ve=function(){return q((function e(){X(this,e);var t=new THREE.CylinderGeometry(4,4,1,10),n=new THREE.MeshPhongMaterial({color:a,shininess:1,specular:16777215,flatShading:!0});this.mesh=new THREE.Mesh(t,n),this.mesh.castShadow=!0,this.angle=0,this.dist=0,ee.add(this)}),[{key:"tick",value:function(e){re(this,e,K.coinsSpeed),this.mesh.rotation.z+=.1*Math.random(),this.mesh.rotation.y+=.1*Math.random(),n(fe.mesh,this.mesh,K.coinDistanceTolerance)?(ue(this.mesh.position.clone(),5,a,.8),N.coins+=1,Re.updateCoinsCount(N.coins),N.statistics.coinsCollected+=1,C.play("coin",{volume:.5}),ee.remove(this)):this.angle>Math.PI&&ee.remove(this)}}])}(),Ee=[],we=function(){return q((function e(t,n,o,a,s,r){X(this,e);var l=i.brownDark;this.damage=t,this.mesh=new THREE.Mesh(new THREE.CylinderGeometry(s,s,r),new THREE.LineBasicMaterial({color:l})),this.mesh.position.copy(n),this.mesh.rotation.z=Math.PI/2,this.direction=o.clone(),this.direction.setLength(1),this.speed=a,ee.add(this),N.statistics.shotsFired+=1}),[{key:"tick",value:function(e){this.mesh.position.add(this.direction.clone().multiplyScalar(this.speed*e)),this.mesh.position.z*=.9,this.mesh.position.x>1e3&&this.remove()}},{key:"remove",value:function(){ee.remove(this),Ee.splice(Ee.indexOf(this),1)}}])}();function Me(e,t,n,o,i,a){Ee.push(new we(e,t,n,o,i,a))}function ge(){var e,t,n=O.getSelection(),a=(e=function(e,t){switch(console.log("Creating airplane mesh with pilot type:",e,"and aircraft type:",t),t){case"blimp":return p(e);case"fighterJet":return function(e){console.log("Creating fighter jet mesh with pilot type:",e);var t=new THREE.Object3D,n=new THREE.ConeGeometry(15,150,32),o=new THREE.MeshPhongMaterial({color:3100495}),i=new THREE.Mesh(n,o);i.rotation.z=Math.PI/2,t.add(i);var a=new THREE.SphereGeometry(12,32,32),s=new THREE.MeshPhongMaterial({color:2003199,opacity:.7,transparent:!0}),r=new THREE.Mesh(a,s);r.position.set(-60,15,0),t.add(r);var l=new THREE.BoxGeometry(50,5,100),h=new THREE.MeshPhongMaterial({color:3100495}),c=new THREE.Mesh(l,h);t.add(c);var u=new THREE.BoxGeometry(20,30,5),p=new THREE.CylinderGeometry(8,10,20,32),m=new THREE.MeshPhongMaterial({color:6908265}),f=new THREE.Mesh(u,h);f.position.set(60,15,-5),t.add(f);var y=f.clone();y.position.set(60,15,5),t.add(y);var v=new THREE.Mesh(p,m);v.position.set(30,-10,-15),t.add(v);var E=v.clone();E.position.set(30,-10,15),t.add(E);var w=new THREE.ConeGeometry(5,20,32),M=new THREE.MeshPhongMaterial({color:13882323}),g=new THREE.Mesh(w,M);g.position.set(-85,0,0),t.add(g);var T=new d(e);return T.mesh.position.set(-60,25,0),t.add(T.mesh),t.castShadow=!0,t.receiveShadow=!0,[t,g,T]}(e);default:return function(e){console.log("Creating original airplane mesh with pilot type:",e);var t=new THREE.Object3D,n=new THREE.MeshPhongMaterial({color:i.red,flatShading:!0,side:THREE.DoubleSide}),a=[40,25,-25],s=[40,25,25],r=[40,-25,-25],l=[40,-25,25],h=[-40,15,-5],c=[-40,15,5],u=[-40,5,-5],p=[-40,5,5],m=new Float32Array(o(s,a,l,r).concat(o(c,h,p,u)).concat(o(h,u,a,r)).concat(o(c,p,s,l)).concat(o(s,c,a,h)).concat(o(l,p,r,u))),f=new THREE.BufferGeometry;f.setAttribute("position",new THREE.BufferAttribute(m,3));var y=new THREE.Mesh(f,n);y.castShadow=!0,y.receiveShadow=!0,t.add(y);var v=new THREE.BoxGeometry(20,50,50,1,1,1),E=new THREE.MeshPhongMaterial({color:i.white,flatShading:!0}),w=new THREE.Mesh(v,E);w.position.x=50,w.castShadow=!0,w.receiveShadow=!0,t.add(w);var M=new THREE.BoxGeometry(15,20,5,1,1,1),g=new THREE.MeshPhongMaterial({color:i.red,flatShading:!0}),T=new THREE.Mesh(M,g);T.position.set(-40,20,0),T.castShadow=!0,T.receiveShadow=!0,t.add(T);var b=new THREE.BoxGeometry(30,5,120,1,1,1),S=new THREE.MeshPhongMaterial({color:i.red,flatShading:!0}),R=new THREE.Mesh(b,S);R.position.set(0,15,0),R.castShadow=!0,R.receiveShadow=!0,t.add(R);var H=new THREE.BoxGeometry(3,15,20,1,1,1),x=new THREE.MeshPhongMaterial({color:i.white,transparent:!0,opacity:.3,flatShading:!0}),P=new THREE.Mesh(H,x);P.position.set(20,27,0),P.castShadow=!0,P.receiveShadow=!0,t.add(P);var k=new THREE.BoxGeometry(20,10,10,1,1,1);k.attributes.position.array[13]-=5,k.attributes.position.array[14]+=5,k.attributes.position.array[16]-=5,k.attributes.position.array[17]-=5,k.attributes.position.array[19]+=5,k.attributes.position.array[20]+=5,k.attributes.position.array[22]+=5,k.attributes.position.array[23]-=5;var C=new THREE.MeshPhongMaterial({color:i.brown,flatShading:!0}),L=new THREE.Mesh(k,C);L.castShadow=!0,L.receiveShadow=!0;var B=new THREE.BoxGeometry(1,80,10,1,1,1),G=new THREE.MeshPhongMaterial({color:i.brownDark,flatShading:!0}),D=new THREE.Mesh(B,G);D.position.set(8,0,0),D.castShadow=!0,D.receiveShadow=!0;var j=D.clone();j.rotation.x=Math.PI/2,j.castShadow=!0,j.receiveShadow=!0,L.add(D),L.add(j),L.position.set(60,0,0),t.add(L);var I=new THREE.BoxGeometry(30,15,10,1,1,1),z=new THREE.MeshPhongMaterial({color:i.red,flatShading:!0}),A=new THREE.Mesh(I,z);A.position.set(25,-20,25),t.add(A);var O=new THREE.BoxGeometry(24,24,4),F=new THREE.MeshPhongMaterial({color:i.brownDark,flatShading:!0}),U=new THREE.Mesh(O,F);U.position.set(25,-28,25);var _=new THREE.BoxGeometry(10,10,6),W=new THREE.MeshPhongMaterial({color:i.brown,flatShading:!0}),X=new THREE.Mesh(_,W);U.add(X),t.add(U);var V=A.clone();V.position.z=-A.position.z,t.add(V);var q=U.clone();q.position.z=-U.position.z,t.add(q);var Y=U.clone();Y.scale.set(.5,.5,.5),Y.position.set(-35,-5,0),t.add(Y);var K=new THREE.BoxGeometry(4,20,4);K.applyMatrix4((new THREE.Matrix4).makeTranslation(0,10,0));var N=new THREE.MeshPhongMaterial({color:i.red,flatShading:!0}),J=new THREE.Mesh(K,N);J.position.set(-35,-5,0),J.rotation.z=-.3,t.add(J);var Z=new d(e);return Z.mesh.position.set(5,27,0),t.add(Z.mesh),t.castShadow=!0,t.receiveShadow=!0,[t,L,Z]}(e)}}(n.pilot,n.aircraft),t=3,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,a,s,r=[],l=!0,h=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=a.call(n)).done)&&(r.push(o.value),r.length!==t);l=!0);}catch(e){h=!0,i=e}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(h)throw i}}return r}}(e,t)||_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=a[0],r=a[1],l=a[2];(fe=new se(s,r,l)).mesh.scale.set(.25,.25,.25),fe.mesh.position.y=K.planeDefaultHeight,J.add(fe.mesh)}function Te(){var e,t,n=(te=(new Date).getTime())-ne;ne=te,"playing"==N.status?N.paused||(Math.floor(N.distance)%K.distanceForCoinsSpawn==0&&Math.floor(N.distance)>N.coinLastSpawn&&(N.coinLastSpawn=Math.floor(N.distance),function(){for(var e=1+Math.floor(10*Math.random()),t=K.seaRadius+K.planeDefaultHeight+(s=1,((a=-1)+Math.random()*(s-a))*(K.planeAmpHeight-20)),n=10+Math.round(10*Math.random()),o=0;o<e;o++){var i=new ve;i.angle=-.02*o,i.distance=t+Math.cos(.5*o)*n,i.mesh.position.y=-K.seaRadius+Math.sin(i.angle)*i.distance,i.mesh.position.x=Math.cos(i.angle)*i.distance}var a,s;N.statistics.coinsSpawned+=e}()),Math.floor(N.distance)%K.distanceForSpeedUpdate==0&&Math.floor(N.distance)>N.speedLastUpdate&&(N.speedLastUpdate=Math.floor(N.distance),N.targetBaseSpeed+=K.incrementSpeedByTime*n),Math.floor(N.distance)%K.distanceForEnemiesSpawn==0&&Math.floor(N.distance)>N.enemyLastSpawn&&(N.enemyLastSpawn=Math.floor(N.distance),function(e){for(var t=0;t<e;t++){var n=new ye;n.angle=-.1*t,n.distance=K.seaRadius+K.planeDefaultHeight+(2*Math.random()-1)*(K.planeAmpHeight-20),n.mesh.position.x=Math.cos(n.angle)*n.distance,n.mesh.position.y=-K.seaRadius+Math.sin(n.angle)*n.distance}N.statistics.enemiesSpawned+=e}(N.level)),Math.floor(N.distance)%K.distanceForLevelUpdate==0&&Math.floor(N.distance)>N.levelLastUpdate&&(N.levelLastUpdate=Math.floor(N.distance),N.level+=1,N.level===K.levelCount?(N.status="finished",Se(),Re.showScoreScreen()):(Re.informNextLevel(N.level),pe.updateColor(),me.updateColor(),Re.updateLevelCount(),N.targetBaseSpeed=K.initSpeed+K.incrementSpeedByLevel*N.level)),N.lifes<K.maxLifes&&N.distance-N.lastLifeSpawn>K.pauseLifeSpawn&&Math.random()<.01&&(N.lastLifeSpawn=N.distance,(t=D.get("heart")).traverse((function(e){e instanceof THREE.Mesh&&e.material.color.setHex(16711680)})),t.position.set(0,-1,-3),t.scale.set(5,5,5),new le(t,(function(){N.lifes=Math.min(K.maxLifes,N.lifes+1),Re.updateLifesDisplay()}))),!N.spawnedSimpleGun&&N.distance>K.simpleGunLevelDrop*K.distanceForLevelUpdate&&((e=oe.createMesh()).scale.set(.25,.25,.25),e.position.x=-2,new le(e,(function(){fe.equipWeapon(new oe)})),N.spawnedSimpleGun=!0),!N.spawnedDoubleGun&&N.distance>K.doubleGunLevelDrop*K.distanceForLevelUpdate&&(function(){var e=new THREE.Group,t=oe.createMesh();t.scale.set(.25,.25,.25),t.position.x=-2,t.position.y=-2,e.add(t);var n=oe.createMesh();n.scale.set(.25,.25,.25),n.position.x=-2,n.position.y=2,e.add(n),new le(e,(function(){fe.equipWeapon(new ie)}))}(),N.spawnedDoubleGun=!0),!N.spawnedBetterGun&&N.distance>K.betterGunLevelDrop*K.distanceForLevelUpdate&&(function(){var e=ae.createMesh();e.scale.set(.25,.25,.25),e.position.x=-7,new le(e,(function(){fe.equipWeapon(new ae)}))}(),N.spawnedBetterGun=!0),(Re.mouseButtons[0]||Re.keysDown.Space)&&fe.shoot(),fe.tick(n),N.distance+=N.speed*n*K.ratioSpeedDistance,N.baseSpeed+=(N.targetBaseSpeed-N.baseSpeed)*n*.02,N.speed=N.baseSpeed*N.planeSpeed,Re.updateDistanceDisplay(),N.lifes<=0&&(N.status="gameover")):"gameover"==N.status?(N.speed*=.99,fe.mesh.rotation.z+=2e-4*(-Math.PI/2-fe.mesh.rotation.z)*n,fe.mesh.rotation.x+=3e-4*n,N.planeFallSpeed*=1.05,fe.mesh.position.y-=N.planeFallSpeed*n,fe.mesh.position.y<-200&&(Re.showReplay(),N.status="waitingReplay",C.play("water-splash"))):N.status,N.paused||(fe.tick(n),pe.mesh.rotation.z+=N.speed*n,pe.mesh.rotation.z>2*Math.PI&&(pe.mesh.rotation.z-=2*Math.PI),Q.intensity+=(.5-Q.intensity)*n*.005,ee.tick(n),A.tick(n),pe.tick(n)),$.render(J,Z),requestAnimationFrame(Te)}function be(){N.fpv=!1,Z.position.set(0,K.planeDefaultHeight,200),Z.setRotationFromEuler(new THREE.Euler(0,0,0))}function Se(){N.fpv=!0,Z.position.set(-89,fe.mesh.position.y+20,0),Z.setRotationFromEuler(new THREE.Euler(-1.490248,-1.4124514,-1.48923231)),Z.updateProjectionMatrix()}var Re,He=function(){return q((function e(t){X(this,e),this._elemDistanceCounter=document.getElementById("distValue"),this._elemReplayMessage=document.getElementById("replayMessage"),this._elemLevelCounter=document.getElementById("levelValue"),this._elemLevelCircle=document.getElementById("levelCircleStroke"),this._elemsLifes=document.querySelectorAll("#lifes img"),this._elemCoinsCount=document.getElementById("coinsValue"),document.querySelector("#intro-screen button").onclick=function(){document.getElementById("intro-screen").classList.remove("visible"),t()},document.addEventListener("keydown",this.handleKeyDown.bind(this),!1),document.addEventListener("keyup",this.handleKeyUp.bind(this),!1),document.addEventListener("mousedown",this.handleMouseDown.bind(this),!1),document.addEventListener("mouseup",this.handleMouseUp.bind(this),!1),document.addEventListener("mousemove",this.handleMouseMove.bind(this),!1),document.addEventListener("blur",this.handleBlur.bind(this),!1),document.oncontextmenu=document.body.oncontextmenu=function(){return!1},window.addEventListener("resize",this.handleWindowResize.bind(this),!1),this.width=window.innerWidth,this.height=window.innerHeight,this.mousePos={x:0,y:0},this.canvas=document.getElementById("threejs-canvas"),this.mouseButtons=[!1,!1,!1],this.keysDown={},this._resizeListeners=[]}),[{key:"onResize",value:function(e){this._resizeListeners.push(e)}},{key:"handleWindowResize",value:function(e){this.width=window.innerWidth,this.height=window.innerHeight;var t,n=U(this._resizeListeners);try{for(n.s();!(t=n.n()).done;)(0,t.value)()}catch(e){n.e(e)}finally{n.f()}}},{key:"handleMouseMove",value:function(e){var t=e.clientX/this.width*2-1,n=1-e.clientY/this.height*2;this.mousePos={x:t,y:n}}},{key:"handleTouchMove",value:function(e){e.preventDefault();var t=e.touches[0].pageX/this.width*2-1,n=1-e.touches[0].pageY/this.height*2;this.mousePos={x:t,y:n}}},{key:"handleMouseDown",value:function(e){this.mouseButtons[e.button]=!0,1===e.button&&"playing"===N.status&&fe.shoot()}},{key:"handleKeyDown",value:function(e){this.keysDown[e.code]=!0,"KeyP"===e.code&&(N.paused=!N.paused),"Space"===e.code&&fe.shoot(),"Enter"===e.code&&(N.fpv?be():Se())}},{key:"handleKeyUp",value:function(e){this.keysDown[e.code]=!1}},{key:"handleMouseUp",value:function(e){this.mouseButtons[e.button]=!1,e.preventDefault(),N&&"waitingReplay"==N.status&&(xe(),Re.informNextLevel(1),N.paused=!1,pe.updateColor(),me.updateColor(),Re.updateDistanceDisplay(),Re.updateLevelCount(),Re.updateLifesDisplay(),Re.updateCoinsCount(),Re.hideReplay())}},{key:"handleBlur",value:function(e){this.mouseButtons=[!1,!1,!1]}},{key:"showReplay",value:function(){this._elemReplayMessage.style.display="block"}},{key:"hideReplay",value:function(){this._elemReplayMessage.style.display="none"}},{key:"updateLevelCount",value:function(){this._elemLevelCounter.innerText=N.level}},{key:"updateCoinsCount",value:function(){this._elemCoinsCount.innerText=N.coins}},{key:"updateDistanceDisplay",value:function(){this._elemDistanceCounter.innerText=Math.floor(N.distance);var e=502*(1-N.distance%K.distanceForLevelUpdate/K.distanceForLevelUpdate);this._elemLevelCircle.setAttribute("stroke-dashoffset",e)}},{key:"updateLifesDisplay",value:function(){for(var e=0,t=this._elemsLifes.length;e<t;e+=1){var n=e<N.lifes,o=this._elemsLifes[e];n&&!o.classList.contains("visible")?(o.classList.remove("invisible"),o.classList.add("visible")):n||o.classList.contains("invisible")||(o.classList.remove("visible"),o.classList.add("invisible"))}}},{key:"informNextLevel",value:function(e){var t=document.getElementById("new-level");t.style.visibility="visible",t.style.animationDuration=Math.round(1e3)+"ms",t.children[1].innerText=e,t.classList.add("animating"),setTimeout((function(){document.getElementById("new-level").style.visibility="hidden",t.classList.remove("animating")}),1e3)}},{key:"showScoreScreen",value:function(){document.getElementById("score-screen").classList.add("visible"),document.getElementById("score-coins-collected").innerText=N.statistics.coinsCollected,document.getElementById("score-coins-total").innerText=N.statistics.coinsSpawned,document.getElementById("score-enemies-killed").innerText=N.statistics.enemiesKilled,document.getElementById("score-enemies-total").innerText=N.statistics.enemiesSpawned,document.getElementById("score-shots-fired").innerText=N.statistics.shotsFired,document.getElementById("score-lifes-lost").innerText=N.statistics.lifesLost}},{key:"showError",value:function(e){document.getElementById("error").style.visibility="visible",document.getElementById("error-message").innerText=e}}])}();function xe(){N={status:"playing",speed:0,paused:!1,baseSpeed:35e-5,targetBaseSpeed:35e-5,speedLastUpdate:0,distance:0,coins:0,fpv:!1,spawnedSimpleGun:!1,spawnedDoubleGun:!1,spawnedBetterGun:!1,lastLifeSpawn:0,lifes:K.maxLifes,level:1,levelLastUpdate:0,planeFallSpeed:.001,planeSpeed:0,planeCollisionDisplacementX:0,planeCollisionSpeedX:0,planeCollisionDisplacementY:0,planeCollisionSpeedY:0,coinLastSpawn:0,enemyLastSpawn:0,statistics:{coinsCollected:0,coinsSpawned:0,enemiesKilled:0,enemiesSpawned:0,shotsFired:0,lifesLost:0}},Re.updateDistanceDisplay(),Re.updateLevelCount(),Re.updateLifesDisplay(),Re.updateCoinsCount(),ee.clear(),pe.updateColor(),me.updateColor(),be(),fe.equipWeapon(null)}var Pe=!1;window.addEventListener("load",(function(e){C.load("ocean",null,"/audio/ocean.mp3"),C.load("propeller",null,"/audio/propeller.mp3"),C.load("coin-1","coin","/audio/coin-1.mp3"),C.load("coin-2","coin","/audio/coin-2.mp3"),C.load("coin-3","coin","/audio/coin-3.mp3"),C.load("jar-1","coin","/audio/jar-1.mp3"),C.load("jar-2","coin","/audio/jar-2.mp3"),C.load("jar-3","coin","/audio/jar-3.mp3"),C.load("jar-4","coin","/audio/jar-4.mp3"),C.load("jar-5","coin","/audio/jar-5.mp3"),C.load("jar-6","coin","/audio/jar-6.mp3"),C.load("jar-7","coin","/audio/jar-7.mp3"),C.load("airplane-crash-1","airplane-crash","/audio/airplane-crash-1.mp3"),C.load("airplane-crash-2","airplane-crash","/audio/airplane-crash-2.mp3"),C.load("airplane-crash-3","airplane-crash","/audio/airplane-crash-3.mp3"),C.load("bubble","bubble","/audio/bubble.mp3"),C.load("shot-soft","shot-soft","/audio/shot-soft.mp3"),C.load("shot-hard","shot-hard","/audio/shot-hard.mp3"),C.load("bullet-impact","bullet-impact","/audio/bullet-impact-rock.mp3"),C.load("water-splash","water-splash","/audio/water-splash.mp3"),C.load("rock-shatter-1","rock-shatter","/audio/rock-shatter-1.mp3"),C.load("rock-shatter-2","rock-shatter","/audio/rock-shatter-2.mp3"),D.load("heart"),Re=new He((function(){O.initSelectionScreen()})),document.addEventListener("selectionComplete",(function(e){var t=e.detail;t.pilot,t.aircraft,Pe||(C.play("propeller",{loop:!0,volume:1}),C.play("ocean",{loop:!0,volume:1}),Pe=!0),K={initSpeed:35e-5,incrementSpeedByTime:25e-7,incrementSpeedByLevel:5e-6,distanceForSpeedUpdate:100,ratioSpeedDistance:50,simpleGunLevelDrop:1.1,doubleGunLevelDrop:2.3,betterGunLevelDrop:3.5,maxLifes:3,pauseLifeSpawn:400,levelCount:6,distanceForLevelUpdate:500,planeDefaultHeight:100,planeAmpHeight:80,planeAmpWidth:75,planeMoveSensivity:.005,planeRotXSensivity:8e-4,planeRotZSensivity:4e-4,planeMinSpeed:1.2,planeMaxSpeed:1.6,seaRadius:600,seaLength:800,wavesMinAmp:5,wavesMaxAmp:20,wavesMinSpeed:.001,wavesMaxSpeed:.003,cameraSensivity:.002,coinDistanceTolerance:15,coinsSpeed:.5,distanceForCoinsSpawn:50,collectibleDistanceTolerance:15,collectiblesSpeed:.6,enemyDistanceTolerance:10,enemiesSpeed:.6,distanceForEnemiesSpawn:50},function(){function e(){$.setSize(Re.width,Re.height),Z.aspect=Re.width/Re.height,Z.updateProjectionMatrix()}J=new THREE.Scene,Z=new THREE.PerspectiveCamera(50,Re.width/Re.height,.1,1e4),C.setCamera(Z),J.fog=new THREE.Fog(16243114,100,950),($=new THREE.WebGLRenderer({canvas:Re.canvas,alpha:!0,antialias:!0})).setSize(Re.width,Re.height),$.setPixelRatio(window.devicePixelRatio?window.devicePixelRatio:1),$.shadowMap.enabled=!0,e(),Re.onResize(e)}(),(pe=new de).mesh.position.y=-K.seaRadius,J.add(pe.mesh),(me=new de).mesh.position.y=-K.seaRadius,J.add(me.mesh),(A=new he).mesh.position.y=-K.seaRadius,J.add(A.mesh),function(){var e=new THREE.HemisphereLight(11184810,0,.9);Q=new THREE.AmbientLight(14452852,.5);var t=new THREE.DirectionalLight(16777215,.9);t.position.set(150,350,350),t.castShadow=!0,t.shadow.camera.left=-400,t.shadow.camera.right=400,t.shadow.camera.top=400,t.shadow.camera.bottom=-400,t.shadow.camera.near=1,t.shadow.camera.far=1e3,t.shadow.mapSize.width=4096,t.shadow.mapSize.height=4096,J.add(e),J.add(t),J.add(Q)}(),ge(),xe(),Te(),Re.informNextLevel(1),N.paused=!1})),R.catch((function(e){Re.showError(e.message)}))}),!1);const ke=N={speed:.01,canDie:!0}})();